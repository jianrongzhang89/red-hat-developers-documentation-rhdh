[id='proc-install-rhdh-operator_{context}']
= Installing {product} using the Operator

[IMPORTANT]
====
The {product} Operator is a Technology Preview feature only.

Technology Preview features are not supported with Red Hat production service level agreements (SLAs), might not be functionally complete, and Red Hat does not recommend using them for production. These features provide early access to upcoming product features, enabling customers to test functionality and provide feedback during the development process.

For more information on Red Hat Technology Preview features, see https://access.redhat.com/support/offerings/techpreview/[Technology Preview Features Scope].
====

This section describes the installation procedure for installing {product} on your OpenShift Container Platform using the Operator.

//You can use the {product} Operator in Red Hat OpenShift (OpenShift) to install {product}.

.Prerequisites

* You are logged in as an administrator on the OpenShift web console.
* You have configured the appropriate roles and permissions within your project to create an application. See the link:https://docs.openshift.com/container-platform/4.14/applications/index.html[Red Hat OpenShift documentation on Building applications] for more details.
* If installing a CI build from quay.io/rhdh, make sure that:
** you have been granted permission to pull images from the `rhdh` organization on quay.io, and 
** you have added your Quay token to the cluster global pull secret (link:https://docs.openshift.com/container-platform/4.14/openshift_images/managing_images/using-image-pull-secrets.html#images-update-global-pull-secret_using-image-pull-secrets[link]):
+
[source]
----
oc get secret/pull-secret -n openshift-config --template='{{index .data ".dockerconfigjson" | base64decode}}' > /tmp/my-global-pull-secret.yaml

oc registry login --registry="quay.io" --auth-basic="<user>:<token>" --to=/tmp/my-global-pull-secret.yaml

oc set data secret/pull-secret -n openshift-config --from-file=.dockerconfigjson=/tmp/my-global-pull-secret.yaml

rm -f /tmp/my-global-pull-secret.yaml
----
** you have added a link:https://gist.github.com/nickboldt/d54ba9d7264a5480d14eea6c3bd2ecdf[RHDH Operator Catalog Source]:
+
[source]
----
curl -L https://gist.githubusercontent.com/nickboldt/d54ba9d7264a5480d14eea6c3bd2ecdf/raw/76a7f166a17f86ae8e766241b9d648c9821898bb/install-rhdh-next-build.sh | bash
----

.Procedure
. In the *Administrator* perspective of the OpenShift web console, go to *Operators* â†’ *OperatorHub*, search for Red Hat Developer Hub, and install the Red Hat Developer Hub Operator. For more info, see link:https://docs.openshift.com/container-platform/4.14/operators/admin/olm-adding-operators-to-cluster.html#olm-installing-from-operatorhub-using-web-console_olm-adding-operators-to-a-cluster[Installing from OperatorHub using the web console]. It is recommended to deploy the Backstage Operator in a dedicated default namespace `rhdh-operator`. The cluster administrator can restrict other users the access to the operator resources through RoleBindings or ClusterRoleBindings. You can choose to deploy the operator in the `openshift-operators` namespace instead. However, you should keep in mind that the Backstage Operator shares the namespace with other operators and therefore any users who can create workloads in that namespace can get their privileges escalated from all operators' service accounts.
. Create an OpenShift project to be used by your Backstage instance. For more information about creating a project in OpenShift, see the link:https://docs.openshift.com/container-platform/4.14/applications/projects/working-with-projects.html#creating-a-project-using-the-web-console_projects[Red Hat OpenShift documentation].
. Administrative and non-administrative users can now use the *Developer* perspective in the Red Hat OpenShift web console. Switch to that perspective now.
. Click *+Add*.
. From the *Developer Catalog* panel, click *Operator Backed*.
. Search for _Backstage_ in the search bar and select the *Backstage* card.
. Click *Create*.
. If needed, use the *Form view* or *YAML view* to change the configuration parameters for {product}.
. Click *Create* and wait for the database and {product} to start.
. Click the *Open URL* option to start using the {product} platform.
+
image::rhdh/rhdh-operator-topology.png[]

.Install {product} with custom {product} image
You can use the {product} Operator to install a {product} application with a custom {product} image. To do so, you can either use the *Form view* and enter the image in *application* -> *image*, or use the *YAML view* to enter the image directly in the {product} custom resource *spec*:
[source,yaml]
----
spec:
  application:
    image: <your custom image>
----

[WARNING]
====
Installing a {product} application with a custom {product} image is at your own risk. It is your responsibility to ensure that the image is from trusted sources, and has been tested and validated for security compliance. Red Hat only supports the images shipped within the {product} Operator.
====